
{
    "stampede2": {
        "resource" : {
            "description"                 : "https://www.tacc.utexas.edu/stampede2/",
            "lrms"                        : "SLURM",
            "cores_per_node"              : 68,
            "gpus_per_node"               : 1
        },
        "access" : {
            "default_queue"               : "normal",
            "mandatory_args"              : ["project"],
            "schemas" : {
                "default"                 : "gsissh",
                "gsissh" : {
                    "job_manager_endpoint": "slurm+gsissh://stampede2.tacc.utexas.edu:2222/",
                    "filesystem_endpoint" : "gsisftp://stampede2.tacc.utexas.edu:2222/"
                },
                "ssh" : {
                    # FIXME: TFA support?
                    "job_manager_endpoint": "slurm+ssh://stampede2.tacc.utexas.edu/",
                    "filesystem_endpoint" : "sftp://stampede2.tacc.utexas.edu/"
                },
                "go": {
                    "job_manager_endpoint": "slurm+ssh://stampede2.tacc.utexas.edu/",
                    "filesystem_endpoint" : "go://xsede#stampede2/"
                }
            }
        },
        "bootstrap" : {
            "default" : "python", 
            "python" : {
                "valid_roots"             : ["/scratch", "$SCRATCH", "/work", "$WORK"],
                "default_sandbox_base"    : "$WORK",
                "python_dist"             : "default", 
                "virtenv_mode"            : "create",
                "rp_version"              : "local",
                "pre_bootstrap_0"         : ["module load TACC",
                                             "module load intel/17.0.4",
                                             "module load python/2.7.13"],
                "export_to_cu"            : ["LMOD_CMD",
                                             "LMOD_SYSTEM_DEFAULT_MODULES",
                                             "LD_LIBRARY_PATH"], 
                "cu_pre_exec"             : ["module restore"], 
                "options" : {
                    "orte" : {
                        "pre_bootstrap_2" : ["module use --append /home/amerzky/ompi/modules",
                                             "module load openmpi/2017_02_17_6da4dbb"]
                    },
                    "ortelib" : {
                        "pre_bootstrap_2" : ["module use --append /home/amerzky/ompi/modules",
                                             "module load openmpi/2017_02_17_6da4dbb"]
                    },
                    "spark" : {
                        "pre_bootstrap_2" : ["module load jdk64/1.8.0"]
                    }
                }
            }, 
            "anaconda" : {
                "valid_roots"             : ["/scratch", "$SCRATCH", "/work", "$WORK"],
                "default_sandbox_base"    : "$WORK",
                "python_dist"             : "anaconda", 
                "virtenv_mode"            : "create",
                "rp_version"              : "local",
                "pre_bootstrap_0"         : ["module load TACC",
                                             "module load intel/17.0.4",
                                             "module load python-anaconda/2.7.13"],
                "export_to_cu"            : ["LMOD_CMD",
                                             "LMOD_SYSTEM_DEFAULT_MODULES",
                                             "LD_LIBRARY_PATH"], 
                "cu_pre_exec"             : ["module restore"], 
                "options" : {
                    "orte" : {
                        "pre_bootstrap_2" : ["module use --append /home/amerzky/ompi/modules",
                                             "module load openmpi/2017_02_17_6da4dbb"]
                    },
                    "ortelib" : {
                        "pre_bootstrap_2" : ["module use --append /home/amerzky/ompi/modules",
                                             "module load openmpi/2017_02_17_6da4dbb"]
                    },
                    "spark" : {
                        "pre_bootstrap_2" : ["module load jdk64/1.8.0"]
                    }
                }
            }
        }
    },

    # YARN
    #   "agent_type"                  : "multicore",
    #   "agent_scheduler"             : "YARN",
    #   "agent_spawner"               : "ABDS",
    #   "agent_launch_method"         : "SSH",
    #   "task_launch_method"          : "YARN",
    #   "mpi_launch_method"           : "MPIRUN_RSH",
    #
    # SPARK:
    #   "agent_type"                  : "multicore",
    #   "agent_scheduler"             : "CONTINUOUS",
    #   "agent_spawner"               : "POPEN",
    #   "agent_launch_method"         : "FORK",
    #   "task_launch_method"          : "SPARK",
    #   "mpi_launch_method"           : "MPIRUN_RSH",

    "wrangler": {
        "resource" : {
            "description"                 : "https://www.tacc.utexas.edu/wrangler/",
            "lrms"                        : "SLURM",
            "cores_per_node"              : 16,
            "gpus_per_node"               : 1
        },
        "access" : {
            "default_queue"               : "normal",
            "mandatory_args"              : ["project"],
            "schemas" : {
                "default"                 : "gsissh",
                "gsissh": {
                    "job_manager_endpoint": "slurm+gsissh://wrangler.tacc.utexas.edu:2222/",
                    "filesystem_endpoint" : "gsisftp://wrangler.tacc.utexas.edu:2222/"
                },
                "ssh": {
                    "job_manager_endpoint": "slurm+ssh://wrangler.tacc.utexas.edu/",
                    "filesystem_endpoint" : "sftp://wrangler.tacc.utexas.edu/"
                },
                "go": {
                    "job_manager_endpoint": "slurm+ssh://wrangler.tacc.utexas.edu/",
                    "filesystem_endpoint" : "go://xsede#wrangler/"
                }
            }
        },
        "bootstrap" : {
            "valid_roots"                 : ["/work", "$WORK", "/data", "$DATA"],
            "default_sandbox_base"        : "$WORK",
            "python_dist"                 : "default", 
            "virtenv_mode"                : "create",
            "rp_version"                  : "local",
            "pre_bootstrap_0"             : ["module load python",
                                             "export TACC_DELETE_FILES=TRUE"],
            "pre_bootstrap_1"             : ["export PATH=$PATH",
                                             "export LD_LIBRARY_PATH=$LD_LIBRARY_PATH"],
            "export_to_cu"                : ["LMOD_CMD",
                                             "LMOD_SYSTEM_DEFAULT_MODULES",
                                             "LD_LIBRARY_PATH"], 
            "cu_pre_exec"                 : ["module restore"]
        }
    },

    "comet": {
        "resource" : {
            "description"                 : "http://www.sdsc.edu/services/hpc/hpc_systems.html#comet",
            "lrms"                        : "SLURM",
            "cores_per_node"              : 24,
            "gpus_per_node"               : 1
        },
        "access" : {
            "default_queue"               : "compute",
            "mandatory_args"              : ["project"],
            "schemas" : {
                "default"                 : "gsissh",
                "ssh"                     :
                {
                    # FIXME: TFA support?
                    "job_manager_endpoint": "slurm+ssh://comet.sdsc.xsede.org/",
                    "filesystem_endpoint" : "sftp://comet.sdsc.xsede.org/"
                },
                "gsissh"                  :
                {
                    "job_manager_endpoint": "slurm+gsissh://comet.sdsc.xsede.org/",
                    "filesystem_endpoint" : "gsisftp://comet.sdsc.xsede.org/"
                }
            }
        },
        "bootstrap" : {
          # "default_sandbox_base"        : "/oasis/scratch/comet/$USER/temp_project",
          # "valid_roots"                 : ["/oasis/scratch/comet"],
            "valid_roots"                 : ["/home"],
            "default_sandbox_base"        : "$HOME",
            "python_dist"                 : "default", 
            "virtenv_mode"                : "create",
            "rp_version"                  : "local",
            "pre_bootstrap_0"             : ["module load python"],
            "pre_bootstrap_1"             : ["export PATH=$PATH",
                                             "export LD_LIBRARY_PATH=$LD_LIBRARY_PATH"],
          # # ORTE / ORTELIB
          # "pre_bootstrap_2"             : ["module use --append /home/amerzky/ompi/modules",
          #                                  "module load openmpi/2017_02_17_6da4dbb"],
            "export_to_cu"                : ["LMOD_CMD",
                                             "LMOD_SYSTEM_DEFAULT_MODULES",
                                             "LD_LIBRARY_PATH"], 
            "cu_pre_exec"                 : ["module restore"],
            "cu_tmp"                      : "/scratch/$USER/$SLURM_JOBID"
        }
    },

    "supermic": {
        "resource" : {
            "description"                 : "https://www.xsede.org/lsu-supermic/",
            "lrms"                        : "TORQUE",
            "cores_per_node"              : 20,
            "gpus_per_node"               : 0
        },
        "access" : {
            "default_queue"               : "workq",
            "mandatory_args"              : ["project"],
            "schemas" : {
                "default"                 : "gsissh",
                "gsissh"                  : {
                    "job_manager_endpoint": "torque+gsissh://supermic.cct-lsu.xsede.org:2222/",
                    "filesystem_endpoint" : "gsisftp://supermic.cct-lsu.xsede.org:2222/"
                },
                "ssh"                     : {
                    # FIXME: TFA support?
                    "job_manager_endpoint": "torque+ssh://supermic.cct-lsu.xsede.org/",
                    "filesystem_endpoint" : "sftp://supermic.cct-lsu.xsede.org/"
                }
            }
        },
        "bootstrap" : {
            "valid_roots"                 : ["/work"],
            "default_sandbox_base"        : "/work/$USER",
            "python_dist"                 : "default", 
            "virtenv_mode"                : "create",
            "rp_version"                  : "local",
            "pre_bootstrap_0"             : ["module load python/2.7.7-anaconda"]
          # # ORTE / ORTELIB
          # "pre_bootstrap_1"             : ["export PATH=$PATH",
          #                                  "export LD_LIBRARY_PATH=$LD_LIBRARY_PATH"],
          # "pre_bootstrap_2"             : ["module use -a /worka/work/amerzky/radical.pilot.sandbox/openmpi/modules/",
          #                                  "module load openmpi/2017_03_13_6da4dbb"]
        }
    },

    "bridges": {
        "resource" : {
            "description"                 : "https://www.xsede.org/psc-bridges/",
            "lrms"                        : "SLURM",
            "cores_per_node"              : nil,
            "gpus_per_node"               : nil
        },
        "access" : {
            "default_queue"               : "normal",
            "mandatory_args"              : [],
            "schemas" : {
                "default"                 : "gsissh",
                "gsissh" : {
                    "job_manager_endpoint": "slurm+gsissh://bridges.psc.xsede.org:2222/",
                    "filesystem_endpoint" : "gsisftp://bridges.psc.xsede.org:2222/"
                },
                "ssh" : {
                    # FIXME: TFA support?
                    "job_manager_endpoint": "slurm+ssh://bridges.psc.xsede.org/",
                    "filesystem_endpoint" : "sftp://bridges.psc.xsede.org/"
                },
                "go" : {
                    "job_manager_endpoint": "slurm+ssh://bridges.psc.xsede.org/",
                    "filesystem_endpoint" : "go://xsede#bridges/"
                }
            }
        },
        "bootstrap" : {
            "valid_roots"                 : ["/home", "/pylon1", "/pylon2"],
            "default_sandbox_base"        : "$HOME",
            "python_dist"                 : "default", 
            "virtenv_mode"                : "create",
            "rp_version"                  : "local",
            "pre_bootstrap_0"             : ["module purge",
                                             "module load gcc",
                                             "module load mpi/gcc_openmpi",
                                             "module load slurm",
                                             "module load python2"]
        }
    }
}

